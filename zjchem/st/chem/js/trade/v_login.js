$(function(){$("#username").blur(function(){var a=$("#username").val();a&&$("#username").val(a.toLowerCase())});$("button").bind("click",function(){if(!snBase.account.isBrowserSuport())return!1;viladate();if($("#error").html())return $("#yzmli").show(),!1;var a=$("#username").val(),d=$("#pwd").val(),b=$("#yzm").val(),c=!1;if(!$("#yzmli").is(":hidden")){c=checkCode(b);if(!c.check)return $(".error").text(c.message),$("#codechange").click(),$("#yzm").val(""),!1;c=!0}$.ajax({type:"POST",url:snBase.account.url.loginURL,
data:{username:a,password:d,checkCode:b,userType:"BLog",autoLogin:"true",needsCheckCode:c},global:!1,success:function(a){if("success"==a.result){setCookie("username",a.langname1,365);if(a=window.localStorage||window.sessionStorage)a.removeItem("SHT_INIT_Effective"),a.removeItem("SHT_INIT_Guidance");a=null;if(a=getUrlPara("rollback_url")){var b=a.indexOf("?");if(0<b){var c=a.substr(b+1);a=a.substr(0,b+1)+decodeURI(c)}}else a=snBase.account.url.userCenterUrl,a||(a=snBase.account.url.homepage);window.location.href=
a}else $("#error").css("visibility","visible").text(a.errinfo),$("#codechange").click(),$("#yzmli").show(),$("#yzm").val("")},dataType:"json"});return!1})});
function viladate(){var a=[{isKong:"\u8bf7\u8f93\u5165\u7535\u5b50\u90ae\u7bb1/\u624b\u673a\u53f7",isGeshi:"\u8bf7\u8f93\u5165\u6709\u6548\u7684\u90ae\u7bb1/\u624b\u673a\u53f7",isMatch:"\u8be5\u8d26\u53f7\u4e0d\u5b58\u5728"},{isKong:"\u8bf7\u8f93\u5165\u5bc6\u7801",isMatch:"\u60a8\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"},{isKong:"\u9a8c\u8bc1\u7801\u4e0d\u80fd\u4e3a\u7a7a",isMatch:"\u9a8c\u8bc1\u7801\u4e0d\u6b63\u786e"}];$("#error").html("");$(".login-pwd").find("input").each(function(d){if("yzm"==
$(".login-pwd").find("input")[d].id&&$("#yzmli").is(":hidden"))return!1;var b=trim($(this).val());if(!b)return $("#error").html(a[d].isKong),!1;if(0==d&&!isMail(b)&&!isMobileNumber(b))return $("#error").html(a[d].isGeshi),!1})}function isMail(a){return/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(a)}function isMobileNumber(a){return/^1\d{10}$/.test(a)}function trim(a){return a.replace(/(^\s*)|(\s*$)/g,"")}
function getUrlPara(a){a=RegExp(a+"\x3d([^\x26]*)(\x26|$)","i");a=window.location.search.substr(1).match(a);return null!=a?unescape(a[1]):null}function clearCookie(a){setCookie(a,"",-1)}function setCookie(a,d,b){var c=new Date;c.setDate(c.getDate()+b);document.cookie=a+"\x3d"+escape(d)+(null==b?"":";expires\x3d"+c.toGMTString())}
function getCookie(a){return 0<document.cookie.length&&(c_start=document.cookie.indexOf(a+"\x3d"),-1!=c_start)?(c_start=c_start+a.length+1,c_end=document.cookie.indexOf(";",c_start),-1==c_end&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):""};